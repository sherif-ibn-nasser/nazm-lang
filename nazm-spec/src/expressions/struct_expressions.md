## تعبيرات الهياكل

تعبيرات الهياكل تُستخدم لإنشاء قيمة من هيكل معين. يبدأ التعبير بعلامة النقطة (`.`)، ثم مسار الهيكل أو اسمه، ثم يتم تعريف القيم المطلوبة له. إليك مثال بذلك:

البداية.نظم:

```nazm
هيكل نقطة(ص4، ص4)

هيكل بدون_قيم؛

دالة البداية() {
    احجز الاسم = "شريف"؛

    احجز _شخص: شخص = .ملف_آخر::شخص {
        الاسم، // إذا كان يتم تمرير متغير بنفس اسم الحقل، فيمكن كتابة اسم الحقل فقط
        العمر = 21
    }؛

    احجز _نقطة = .نقطة(5، 10)؛

    احجز بدون = .بدون_قيم؛

    // التعبيرات التالية تعطي خطأ؛ ﻷنه لا تطابق تعريف الهيكل

    // احجز بدون2 = .بدون_قيم {}؛

    // احجز بدون3 = .بدون_قيم ()؛

}
```

ملف_آخر.نظم:

```nazm
هيكل شخص {
    الاسم: #متن،
    العمر: ط4،
}
```

### النحو

> `تعبير_هيكل` :
>
> &emsp; '**`.`**' &nbsp; [تعبير_مسار](paths_expressions.md#النحو) &nbsp; ( **`تعبير_هيكل_ذي_ترتيب`** &nbsp; \| &nbsp; **`تعبير_هيكل_ذي_حقول`** )<sup>؟</sup>
>
> `تعبير_هيكل_ذي_ترتيب` :
>
> &emsp; '**`(`**' &nbsp; **`قيمة_ترتيب_لهيكل`**<sup>؟</sup> &nbsp; '**`)`**'
>
> `تعبير_هيكل_ذي_حقول` :
>
> &emsp; '**`{`**' &nbsp; **`قيم_حقول_لهيكل`**<sup>؟</sup> &nbsp; '**`}`**'
>
> `قيمة_ترتيب_لهيكل` :
>
> &emsp; [تعبير](../expressions.md) &nbsp; ( '**`،`**' &nbsp; [تعبير](../expressions.md) )<sup>\*</sup> &nbsp; **`،`**<sup>؟</sup>
>
> `قيم_حقول_لهيكل` :
>
> &emsp; **`قيمة_حقل_لهيكل`** &nbsp; ( '**`،`**' &nbsp; **`قيمة_حقل_لهيكل`** )<sup>\*</sup> &nbsp; **`،`**<sup>؟</sup>
>
> `قيمة_حقل_لهيكل` :
>
> &emsp; [اسم](../tokens/identifiers.md) ( '**`=`**' &nbsp; [تعبير](../expressions.md) )<sup>؟</sup>

على الرغم من أن عملية [تحليل المسارات]() يُمكنها التعرف على نوع العنصر المُشار إليه، إلا أن
بدء القاعدة النحوية لتعبيرات الهياكل بعلامة النقطة (`.`) يُسهِّل تمييزها عن [تعبيرات الاستدعاء](call_expressions.md#النحو) أثناء قراءة الكود، فهذا ما سيحصل إذا لم تبدأ بعلامة النقطة:

```nazm
احجز متغير العمر = 21؛

// إذا لم نجعل تعبيرات الهياكل تبدأ بنقطة
// فهل سنفهم أن الكود يقصد تعريف هيكل اسمه "شخص" ويتم تعريف حقل العمر فيه
// أم أن هناك دالة عالية الرتبة `شخص ( كود: () -> () )`
// ولكننا نقوم بتغيير قيمة المتغير الأعلى من داخلها؟
احجز _شخص = شخص { العمر = 5 }؛

// هل نقوم هنا أيضاً باستدعاء دالة أم إنشاء نسخة من الهيكل "نقطة"؟
احجز _نقطة = نقطة(2، 3)؛

// هل هذا نساويه بمتغير آخر اسمه بدون_قيم أم نسخة جديدة من هيكل؟
احجز بدون = بدون_قيم؛

// هل هذه دالة عالية الرتبة أم هيكل؟
احجز بدون2 = بدون_قيم2 {}؛
```

> [!مهم]
> أثناء عملية [تحليل المسارات]() ،يُمكن التعرف على نوع العنصر إذا كان دالة أو هيكل أو متغير في الحالة الثانية والثالثة (وذلك لأن كل عنصر يجب أن يكون له اسم مختلف عن الآخر)،
> ولكن ستحتاج العملية جهد أكبر في الحالة الأولى والرابعة للتمييز إذا كان المسار يشير إلى هيكل أو دالة عالية الرتبة.
>
> من الممكن أن يقترح البعض أن تكون القاعدة النحوية في الحالة الأولى لتعبيرات الهياكل مثل لغة C، بوضع علامة النقطة قبل أسماء الحقول كالتالي:
>
> ```nazm
> احجز _شخص = شخص { .العمر = 21 }؛
> ```
>
> بالطبع هذا سيحل المشكلة في تلك الحالة،
> ولكن ستظل المشكلة موجودة في الحالة الرابعة
> حيث يمكن اعتبارها كتعبير لهيكل بدون حقول أو تمرير تعبير [لامدا مُلحَق](call_expressions.md#تعبيرات-اللامدا-المُلحَقة) لدالة عالية الرتبة.
> حينئذ، يمكن أن يبذل المترجم الجهد في الحالة الرابعة للتمييز بين التعبيرين،
> ولكن وجود تلك الحالة يجعلنا لا نضمن في المستقبل أن تظهر حالة أخرى لا يمكن التمييز فيها،
> مما يجعل إضافة النقطة قبل تعبيرات الهياكل أكثر استقراراً في جميع الحالات، وتوفيراً لجهد المترجم، وكذلك أوضح في القراءة أننا نريد إنشاء نسخة من هيكل وليس استدعاء دالة.
